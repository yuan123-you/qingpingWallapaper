{"version":3,"file":"list.js","sources":["pages/wallpaper/list.vue","../../../HBuilder X/HBuilderX.4.87.2025121004/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvd2FsbHBhcGVyL2xpc3QudnVl"],"sourcesContent":["<template>\n  <view class=\"page-bg\">\n    <view class=\"wallpaper-list-container\">\n      <view class=\"list-header\">\n        <text class=\"list-title\">{{ classifyName || '壁纸列表' }}</text>\n        <text class=\"list-count\">{{ wallpaperList.length }}张</text>\n      </view>\n\n      <scroll-view class=\"wallpaper-scroll\" scroll-y @scrolltolower=\"loadMore\">\n        <view class=\"wallpaper-grid\">\n          <view \n            class=\"wallpaper-item\" \n            v-for=\"(item, index) in wallpaperList\" \n            :key=\"index\"\n            @click=\"goToPreview(item)\"\n          >\n            <image class=\"wallpaper-image\" :src=\"item.pic_url\" mode=\"aspectFill\"></image>\n            <view class=\"wallpaper-info\">\n              <text class=\"wallpaper-title\">{{ item.title || '壁纸' }}</text>\n              <view class=\"wallpaper-meta\">\n                <text class=\"meta-item\">★ {{ item.score || '0.0' }}</text>\n                <text class=\"meta-item\">↓ {{ formatNumber(item.download_count || 0) }}</text>\n              </view>\n            </view>\n          </view>\n        </view>\n        \n        <view class=\"loading-more\" v-if=\"loading\">\n          <text>加载中...</text>\n        </view>\n        \n        <view class=\"no-more\" v-if=\"!hasMore && wallpaperList.length > 0\">\n          <text>没有更多了</text>\n        </view>\n        \n        <view class=\"empty\" v-if=\"wallpaperList.length === 0 && !loading\">\n          <text>暂无壁纸</text>\n        </view>\n      </scroll-view>\n    </view>\n    <view class=\"safe-area-bottom\"></view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { getWallpaperList } from '@/api/user/index.js'\n\nconst classifyId = ref('')\nconst classifyName = ref('')\nconst wallpaperList = ref([])\nconst loading = ref(false)\nconst hasMore = ref(true)\nconst pageNum = ref(1)\nconst pageSize = 20\n\nonMounted(() => {\n  const pages = getCurrentPages()\n  const currentPage = pages[pages.length - 1]\n  classifyId.value = currentPage.options.id || ''\n  classifyName.value = currentPage.options.name || ''\n  loadWallpaperList()\n})\n\nasync function loadWallpaperList(refresh = false) {\n  if (loading.value) return\n  \n  loading.value = true\n  \n  try {\n    const params = {\n      pageNum: refresh ? 1 : pageNum.value,\n      pageSize\n    }\n    \n    if (classifyId.value) {\n      params.class_id = classifyId.value\n    }\n    \n    const res = await getWallpaperList(params)\n    \n    if (res && res.list) {\n      if (refresh) {\n        wallpaperList.value = res.list\n        pageNum.value = 1\n      } else {\n        wallpaperList.value = [...wallpaperList.value, ...res.list]\n      }\n      \n      hasMore.value = res.list.length >= pageSize\n    }\n  } catch (error) {\n    console.error('加载壁纸列表失败:', error)\n  } finally {\n    loading.value = false\n  }\n}\n\nfunction goToPreview(item) {\n  uni.navigateTo({\n    url: `/pages/preview/preview?id=${item.id}`\n  })\n}\n\nfunction loadMore() {\n  if (!hasMore.value || loading.value) return\n  pageNum.value++\n  loadWallpaperList()\n}\n\nfunction formatNumber(num) {\n  if (num >= 10000) {\n    return (num / 10000).toFixed(1) + '万'\n  } else if (num >= 1000) {\n    return (num / 1000).toFixed(1) + 'k'\n  }\n  return num.toString()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.wallpaper-list-container {\n  min-height: 100vh;\n  background: #fff;\n}\n\n.list-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 30rpx;\n  border-bottom: 1rpx solid #F5F5F5;\n}\n\n.list-title {\n  font-size: 36rpx;\n  font-weight: 600;\n  color: #333;\n}\n\n.list-count {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.wallpaper-scroll {\n  height: calc(100vh - 200rpx);\n}\n\n.wallpaper-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 20rpx;\n  padding: 20rpx 30rpx;\n}\n\n.wallpaper-item {\n  background: #fff;\n  border-radius: 16rpx;\n  overflow: hidden;\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.08);\n}\n\n.wallpaper-image {\n  width: 100%;\n  height: 400rpx;\n  display: block;\n}\n\n.wallpaper-info {\n  padding: 20rpx;\n}\n\n.wallpaper-title {\n  font-size: 26rpx;\n  color: #333;\n  font-weight: 500;\n  display: block;\n  margin-bottom: 15rpx;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.wallpaper-meta {\n  display: flex;\n  gap: 20rpx;\n}\n\n.meta-item {\n  font-size: 22rpx;\n  color: #999;\n}\n\n.loading-more,\n.no-more,\n.empty {\n  text-align: center;\n  padding: 30rpx;\n  color: #999;\n  font-size: 24rpx;\n}\n\n.safe-area-bottom {\n  height: constant(safe-area-inset-bottom);\n  height: env(safe-area-inset-bottom);\n}\n</style>\n","import MiniProgramPage from 'D:/HBuilderPrograms/qingpingWallapaper/frontend/pages/wallpaper/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onMounted","getWallpaperList","uni"],"mappings":";;;AAsDA,MAAM,WAAW;;;;AANjB,UAAM,aAAaA,cAAG,IAAC,EAAE;AACzB,UAAM,eAAeA,cAAG,IAAC,EAAE;AAC3B,UAAM,gBAAgBA,cAAG,IAAC,EAAE;AAC5B,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,UAAUA,cAAG,IAAC,IAAI;AACxB,UAAM,UAAUA,cAAG,IAAC,CAAC;AAGrBC,kBAAAA,UAAU,MAAM;AACd,YAAM,QAAQ,gBAAiB;AAC/B,YAAM,cAAc,MAAM,MAAM,SAAS,CAAC;AAC1C,iBAAW,QAAQ,YAAY,QAAQ,MAAM;AAC7C,mBAAa,QAAQ,YAAY,QAAQ,QAAQ;AACjD,wBAAmB;AAAA,IACrB,CAAC;AAED,mBAAe,kBAAkB,UAAU,OAAO;AAChD,UAAI,QAAQ;AAAO;AAEnB,cAAQ,QAAQ;AAEhB,UAAI;AACF,cAAM,SAAS;AAAA,UACb,SAAS,UAAU,IAAI,QAAQ;AAAA,UAC/B;AAAA,QACD;AAED,YAAI,WAAW,OAAO;AACpB,iBAAO,WAAW,WAAW;AAAA,QAC9B;AAED,cAAM,MAAM,MAAMC,eAAgB,iBAAC,MAAM;AAEzC,YAAI,OAAO,IAAI,MAAM;AACnB,cAAI,SAAS;AACX,0BAAc,QAAQ,IAAI;AAC1B,oBAAQ,QAAQ;AAAA,UACxB,OAAa;AACL,0BAAc,QAAQ,CAAC,GAAG,cAAc,OAAO,GAAG,IAAI,IAAI;AAAA,UAC3D;AAED,kBAAQ,QAAQ,IAAI,KAAK,UAAU;AAAA,QACpC;AAAA,MACF,SAAQ,OAAO;AACdC,sBAAAA,MAAA,MAAA,SAAA,kCAAc,aAAa,KAAK;AAAA,MACpC,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACjB;AAAA,IACH;AAEA,aAAS,YAAY,MAAM;AACzBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,6BAA6B,KAAK,EAAE;AAAA,MAC7C,CAAG;AAAA,IACH;AAEA,aAAS,WAAW;AAClB,UAAI,CAAC,QAAQ,SAAS,QAAQ;AAAO;AACrC,cAAQ;AACR,wBAAmB;AAAA,IACrB;AAEA,aAAS,aAAa,KAAK;AACzB,UAAI,OAAO,KAAO;AAChB,gBAAQ,MAAM,KAAO,QAAQ,CAAC,IAAI;AAAA,MACtC,WAAa,OAAO,KAAM;AACtB,gBAAQ,MAAM,KAAM,QAAQ,CAAC,IAAI;AAAA,MAClC;AACD,aAAO,IAAI,SAAU;AAAA,IACvB;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpHA,GAAG,WAAW,eAAe;"}