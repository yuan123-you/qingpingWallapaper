{"version":3,"file":"notice.js","sources":["pages/notice/notice.vue","../../../HBuilder X/HBuilderX.4.87.2025121004/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbm90aWNlL25vdGljZS52dWU"],"sourcesContent":["<template>\n  <view class=\"page-bg\">\n    <view class=\"notice-container\">\n      <scroll-view class=\"notice-scroll\" scroll-y @scrolltolower=\"loadMore\">\n        <view class=\"notice-list\">\n          <view \n            class=\"notice-item\" \n            v-for=\"(item, index) in noticeList\" \n            :key=\"index\"\n            @click=\"goToNoticeDetail(item)\"\n          >\n            <text class=\"notice-title\">{{ item.title }}</text>\n            <text class=\"notice-time\">{{ formatTime(item.create_time) }}</text>\n          </view>\n        </view>\n        \n        <view class=\"loading-more\" v-if=\"loading\">\n          <text>加载中...</text>\n        </view>\n        \n        <view class=\"no-more\" v-if=\"!hasMore && noticeList.length > 0\">\n          <text>没有更多了</text>\n        </view>\n        \n        <view class=\"empty\" v-if=\"noticeList.length === 0 && !loading\">\n          <text>暂无公告</text>\n        </view>\n      </scroll-view>\n    </view>\n    <view class=\"safe-area-bottom\"></view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { getNoticeList } from '@/api/user/index.js'\n\nconst noticeList = ref([])\nconst loading = ref(false)\nconst hasMore = ref(true)\nconst pageNum = ref(1)\nconst pageSize = 10\n\nonMounted(() => {\n  loadNotice()\n})\n\nasync function loadNotice(refresh = false) {\n  if (loading.value) return\n  \n  loading.value = true\n  \n  try {\n    const currentPageNum = refresh ? 1 : pageNum.value\n    const res = await getNoticeList('', currentPageNum, pageSize)\n    \n    if (res && res.list) {\n      if (refresh) {\n        noticeList.value = res.list\n        pageNum.value = 1\n      } else {\n        noticeList.value = [...noticeList.value, ...res.list]\n      }\n      \n      hasMore.value = res.list.length >= pageSize\n    }\n  } catch (error) {\n    console.error('加载公告失败:', error)\n  } finally {\n    loading.value = false\n  }\n}\n\nfunction goToNoticeDetail(item) {\n  uni.navigateTo({\n    url: `/pages/notice/detail?id=${item.id}`\n  })\n}\n\nfunction loadMore() {\n  if (!hasMore.value || loading.value) return\n  pageNum.value++\n  loadNotice()\n}\n\nfunction formatTime(timestamp) {\n  if (!timestamp) return ''\n  \n  const date = new Date(timestamp)\n  const now = new Date()\n  const diff = now - date\n  \n  if (diff < 60000) {\n    return '刚刚'\n  } else if (diff < 3600000) {\n    return `${Math.floor(diff / 60000)}分钟前`\n  } else if (diff < 86400000) {\n    return `${Math.floor(diff / 3600000)}小时前`\n  } else if (diff < 2592000000) {\n    return `${Math.floor(diff / 86400000)}天前`\n  } else {\n    return `${Math.floor(diff / 2592000000)}个月前`\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.notice-container {\n  min-height: 100vh;\n  background: #fff;\n}\n\n.notice-scroll {\n  height: calc(100vh - 200rpx);\n}\n\n.notice-list {\n  padding: 20rpx 30rpx;\n}\n\n.notice-item {\n  padding: 30rpx;\n  background: #fff;\n  border-radius: 12rpx;\n  margin-bottom: 20rpx;\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.08);\n}\n\n.notice-title {\n  font-size: 32rpx;\n  font-weight: 500;\n  color: #333;\n  display: block;\n  margin-bottom: 15rpx;\n}\n\n.notice-time {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.loading-more,\n.no-more,\n.empty {\n  text-align: center;\n  padding: 30rpx;\n  color: #999;\n  font-size: 24rpx;\n}\n\n.safe-area-bottom {\n  height: constant(safe-area-inset-bottom);\n  height: env(safe-area-inset-bottom);\n}\n</style>\n","import MiniProgramPage from 'D:/HBuilderPrograms/qingpingWallapaper/frontend/pages/notice/notice.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onMounted","getNoticeList","uni"],"mappings":";;;AAyCA,MAAM,WAAW;;;;AAJjB,UAAM,aAAaA,cAAG,IAAC,EAAE;AACzB,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,UAAUA,cAAG,IAAC,IAAI;AACxB,UAAM,UAAUA,cAAG,IAAC,CAAC;AAGrBC,kBAAAA,UAAU,MAAM;AACd,iBAAY;AAAA,IACd,CAAC;AAED,mBAAe,WAAW,UAAU,OAAO;AACzC,UAAI,QAAQ;AAAO;AAEnB,cAAQ,QAAQ;AAEhB,UAAI;AACF,cAAM,iBAAiB,UAAU,IAAI,QAAQ;AAC7C,cAAM,MAAM,MAAMC,eAAAA,cAAc,IAAI,gBAAgB,QAAQ;AAE5D,YAAI,OAAO,IAAI,MAAM;AACnB,cAAI,SAAS;AACX,uBAAW,QAAQ,IAAI;AACvB,oBAAQ,QAAQ;AAAA,UACxB,OAAa;AACL,uBAAW,QAAQ,CAAC,GAAG,WAAW,OAAO,GAAG,IAAI,IAAI;AAAA,UACrD;AAED,kBAAQ,QAAQ,IAAI,KAAK,UAAU;AAAA,QACpC;AAAA,MACF,SAAQ,OAAO;AACdC,sBAAAA,MAAA,MAAA,SAAA,iCAAc,WAAW,KAAK;AAAA,MAClC,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACjB;AAAA,IACH;AAEA,aAAS,iBAAiB,MAAM;AAC9BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,2BAA2B,KAAK,EAAE;AAAA,MAC3C,CAAG;AAAA,IACH;AAEA,aAAS,WAAW;AAClB,UAAI,CAAC,QAAQ,SAAS,QAAQ;AAAO;AACrC,cAAQ;AACR,iBAAY;AAAA,IACd;AAEA,aAAS,WAAW,WAAW;AAC7B,UAAI,CAAC;AAAW,eAAO;AAEvB,YAAM,OAAO,IAAI,KAAK,SAAS;AAC/B,YAAM,MAAM,oBAAI,KAAM;AACtB,YAAM,OAAO,MAAM;AAEnB,UAAI,OAAO,KAAO;AAChB,eAAO;AAAA,MACX,WAAa,OAAO,MAAS;AACzB,eAAO,GAAG,KAAK,MAAM,OAAO,GAAK,CAAC;AAAA,MACtC,WAAa,OAAO,OAAU;AAC1B,eAAO,GAAG,KAAK,MAAM,OAAO,IAAO,CAAC;AAAA,MACxC,WAAa,OAAO,QAAY;AAC5B,eAAO,GAAG,KAAK,MAAM,OAAO,KAAQ,CAAC;AAAA,MACzC,OAAS;AACL,eAAO,GAAG,KAAK,MAAM,OAAO,MAAU,CAAC;AAAA,MACxC;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;ACtGA,GAAG,WAAW,eAAe;"}