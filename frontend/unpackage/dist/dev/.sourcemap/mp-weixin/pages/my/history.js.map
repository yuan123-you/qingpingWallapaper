{"version":3,"file":"history.js","sources":["pages/my/history.vue","../../../HBuilder X/HBuilderX.4.87.2025121004/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXkvaGlzdG9yeS52dWU"],"sourcesContent":["<template>\n  <view class=\"page-bg\">\n    <view class=\"history-container\">\n      <view class=\"history-header\">\n        <text class=\"history-title\">ÊµèËßàÂéÜÂè≤</text>\n        <text class=\"history-clear\" @click=\"handleClearHistory\">Ê∏ÖÁ©∫</text>\n      </view>\n\n      <view v-if=\"historyList.length === 0\" class=\"empty-state\">\n        <text class=\"empty-icon\">üì≠</text>\n        <text class=\"empty-text\">ÊöÇÊó†ÊµèËßàËÆ∞ÂΩï</text>\n      </view>\n\n      <view v-else class=\"history-list\">\n        <view \n          class=\"history-item\" \n          v-for=\"(item, index) in historyList\" \n          :key=\"index\"\n          @click=\"goToPreview(item)\"\n        >\n          <image class=\"history-image\" :src=\"item.pic_url\" mode=\"aspectFill\"></image>\n          <view class=\"history-info\">\n            <text class=\"history-name\">{{ item.title || 'Â£ÅÁ∫∏' }}</text>\n            <text class=\"history-time\">{{ formatTime(item.viewTime) }}</text>\n          </view>\n          <view class=\"history-actions\">\n            <text class=\"action-btn favorite-btn\" @click.stop=\"toggleFavorite(item)\">\n              {{ isFavorite(item.id) ? '‚ô•' : '‚ô°' }}\n            </text>\n          </view>\n        </view>\n      </view>\n    </view>\n    <view class=\"safe-area-bottom\"></view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { useUserStore } from '@/stores/user'\n\nconst userStore = useUserStore()\n\nconst historyList = computed(() => userStore.history || [])\n\nonMounted(() => {\n  userStore.initUserInfo()\n})\n\nfunction goToPreview(item) {\n  uni.navigateTo({\n    url: `/pages/preview/preview?id=${item.id}`\n  })\n}\n\nfunction handleClearHistory() {\n  uni.showModal({\n    title: 'ÊèêÁ§∫',\n    content: 'Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÊµèËßàËÆ∞ÂΩïÂêóÔºü',\n    success: (res) => {\n      if (res.confirm) {\n        userStore.clearHistory()\n        uni.showToast({\n          title: 'Ê∏ÖÁ©∫ÊàêÂäü',\n          icon: 'success'\n        })\n      }\n    }\n  })\n}\n\nfunction toggleFavorite(item) {\n  if (isFavorite(item.id)) {\n    userStore.removeFavorite(item.id)\n    uni.showToast({\n      title: 'Â∑≤ÂèñÊ∂àÊî∂Ëóè',\n      icon: 'none'\n    })\n  } else {\n    userStore.addFavorite(item)\n    uni.showToast({\n      title: 'Â∑≤Êî∂Ëóè',\n      icon: 'success'\n    })\n  }\n}\n\nfunction isFavorite(id) {\n  return userStore.favorites.some(fav => fav.id === id)\n}\n\nfunction formatTime(timestamp) {\n  if (!timestamp) return ''\n  const date = new Date(timestamp)\n  const now = new Date()\n  const diff = now - date\n  \n  if (diff < 60000) {\n    return 'ÂàöÂàö'\n  } else if (diff < 3600000) {\n    return `${Math.floor(diff / 60000)}ÂàÜÈíüÂâç`\n  } else if (diff < 86400000) {\n    return `${Math.floor(diff / 3600000)}Â∞èÊó∂Ââç`\n  } else if (diff < 604800000) {\n    return `${Math.floor(diff / 86400000)}Â§©Ââç`\n  } else {\n    return `${date.getMonth() + 1}-${date.getDate()}`\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.history-container {\n  min-height: 100vh;\n  padding: 30rpx;\n}\n\n.history-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30rpx;\n}\n\n.history-title {\n  font-size: 36rpx;\n  font-weight: 600;\n  color: #333;\n}\n\n.history-clear {\n  font-size: 28rpx;\n  color: #28b389;\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 200rpx 0;\n}\n\n.empty-icon {\n  font-size: 120rpx;\n  margin-bottom: 30rpx;\n}\n\n.empty-text {\n  font-size: 28rpx;\n  color: #999;\n}\n\n.history-list {\n  display: flex;\n  flex-direction: column;\n  gap: 20rpx;\n}\n\n.history-item {\n  display: flex;\n  align-items: center;\n  background: #fff;\n  border-radius: 16rpx;\n  padding: 20rpx;\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.08);\n}\n\n.history-image {\n  width: 120rpx;\n  height: 180rpx;\n  border-radius: 8rpx;\n  margin-right: 20rpx;\n}\n\n.history-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 10rpx;\n}\n\n.history-name {\n  font-size: 28rpx;\n  color: #333;\n  font-weight: 500;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  max-width: 300rpx;\n}\n\n.history-time {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.history-actions {\n  display: flex;\n  gap: 10rpx;\n}\n\n.action-btn {\n  font-size: 40rpx;\n  padding: 10rpx;\n}\n\n.favorite-btn {\n  color: #ff6b6b;\n}\n\n.safe-area-bottom {\n  height: constant(safe-area-inset-bottom);\n  height: env(safe-area-inset-bottom);\n}\n</style>\n","import MiniProgramPage from 'D:/HBuilderPrograms/qingpingWallapaper/frontend/pages/my/history.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","computed","onMounted","uni"],"mappings":";;;;;;AAyCA,UAAM,YAAYA,YAAAA,aAAc;AAEhC,UAAM,cAAcC,cAAAA,SAAS,MAAM,UAAU,WAAW,CAAA,CAAE;AAE1DC,kBAAAA,UAAU,MAAM;AACd,gBAAU,aAAc;AAAA,IAC1B,CAAC;AAED,aAAS,YAAY,MAAM;AACzBC,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,6BAA6B,KAAK,EAAE;AAAA,MAC7C,CAAG;AAAA,IACH;AAEA,aAAS,qBAAqB;AAC5BA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AACf,sBAAU,aAAc;AACxBA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YAChB,CAAS;AAAA,UACF;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAEA,aAAS,eAAe,MAAM;AAC5B,UAAI,WAAW,KAAK,EAAE,GAAG;AACvB,kBAAU,eAAe,KAAK,EAAE;AAChCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACL,OAAS;AACL,kBAAU,YAAY,IAAI;AAC1BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAEA,aAAS,WAAW,IAAI;AACtB,aAAO,UAAU,UAAU,KAAK,SAAO,IAAI,OAAO,EAAE;AAAA,IACtD;AAEA,aAAS,WAAW,WAAW;AAC7B,UAAI,CAAC;AAAW,eAAO;AACvB,YAAM,OAAO,IAAI,KAAK,SAAS;AAC/B,YAAM,MAAM,oBAAI,KAAM;AACtB,YAAM,OAAO,MAAM;AAEnB,UAAI,OAAO,KAAO;AAChB,eAAO;AAAA,MACX,WAAa,OAAO,MAAS;AACzB,eAAO,GAAG,KAAK,MAAM,OAAO,GAAK,CAAC;AAAA,MACtC,WAAa,OAAO,OAAU;AAC1B,eAAO,GAAG,KAAK,MAAM,OAAO,IAAO,CAAC;AAAA,MACxC,WAAa,OAAO,QAAW;AAC3B,eAAO,GAAG,KAAK,MAAM,OAAO,KAAQ,CAAC;AAAA,MACzC,OAAS;AACL,eAAO,GAAG,KAAK,SAAU,IAAG,CAAC,IAAI,KAAK,QAAO,CAAE;AAAA,MAChD;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;AC3GA,GAAG,WAAW,eAAe;"}