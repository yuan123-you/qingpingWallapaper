{"version":3,"file":"list.js","sources":["pages/wallpaper/list.vue","../../HBuilder X/HBuilderX.4.87.2025121004/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvd2FsbHBhcGVyL2xpc3QudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"header\" :style=\"{ paddingTop: statusBarHeight + 'px' }\">\n      <view class=\"header-inner\">\n        <view class=\"back-btn\" @click=\"goBack\">\n          <uni-icons type=\"left\" size=\"24\" color=\"#1a1a1a\"></uni-icons>\n        </view>\n        <text class=\"title\">{{ classifyName || (type === 'hot' ? '热门排行' : '发现壁纸') }}</text>\n        <view class=\"placeholder\"></view>\n      </view>\n    </view>\n\n    <scroll-view \n      scroll-y \n      class=\"main-list\" \n      @scrolltolower=\"loadMore\"\n      lower-threshold=\"50\"\n    >\n      <view class=\"grid\">\n        <view \n          class=\"wall-card fade-in-up\" \n          v-for=\"(item, index) in list\" \n          :key=\"item.id\"\n          :style=\"{ animationDelay: (index % 10) * 0.05 + 's' }\" \n          @click=\"goToPreview(item)\"\n        >\n          <image :src=\"item.pic_url\" mode=\"aspectFill\" lazy-load></image>\n          <view class=\"overlay\">\n            <view class=\"info\">\n              <text class=\"name\">{{ item.title }}</text>\n              <text class=\"score\">⭐{{ item.score }}</text>\n            </view>\n          </view>\n        </view>\n      </view>\n      \n      <!-- 加载提示 -->\n      <view class=\"loading-status\" v-if=\"loading\">\n        <view class=\"dot-loading\"></view>\n      </view>\n      \n      <!-- 到底提示 -->\n      <view class=\"no-more\" v-if=\"!hasMore && list.length > 0\">\n        <text>MEET THE END</text>\n      </view>\n      \n      <!-- 空状态 -->\n      <view class=\"empty-state\" v-if=\"!loading && list.length === 0\">\n        <text>暂时没有更多壁纸</text>\n      </view>\n      \n      <view class=\"safe-bottom\"></view>\n    </scroll-view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { getWallpaperList } from '@/api/user/index.js'\n\nconst statusBarHeight = ref(uni.getSystemInfoSync().statusBarHeight || 20)\nconst classifyId = ref('')\nconst classifyName = ref('')\nconst type = ref('')\nconst list = ref([])\nconst loading = ref(false)\nconst hasMore = ref(true)\nconst pageNum = ref(1)\nconst pageSize = 10\n\nonMounted(() => {\n  const pages = getCurrentPages()\n  const options = pages[pages.length - 1].options\n  classifyId.value = options.id || ''\n  classifyName.value = options.name || ''\n  type.value = options.type || ''\n  loadData(true)\n})\n\nasync function loadData(reload = false) {\n  if (loading.value) return\n  \n  if (reload) {\n    pageNum.value = 1\n    hasMore.value = true\n    list.value = []\n  }\n\n  if (!hasMore.value) return\n\n  loading.value = true\n  \n  try {\n    const res = await getWallpaperList({ \n      categoryId: classifyId.value,\n      type: type.value,\n      pageNum: pageNum.value,\n      pageSize: pageSize\n    })\n    \n    // 如果是第一页，直接覆盖；否则追加\n    if (pageNum.value === 1) {\n      list.value = res.list\n    } else {\n      list.value = [...list.value, ...res.list]\n    }\n    \n    // 判断是否加载完毕\n    if (list.value.length >= res.total || res.list.length < pageSize) {\n      hasMore.value = false\n    } else {\n      pageNum.value++\n    }\n  } catch (e) {\n    console.error('Loader error:', e)\n  } finally {\n    loading.value = false\n  }\n}\n\nfunction loadMore() {\n  if (!loading.value && hasMore.value) {\n    loadData()\n  }\n}\n\nfunction goToPreview(item) {\n  uni.navigateTo({ \n    url: `/pages/preview/preview?id=${item.id}&type=${type.value}&categoryId=${classifyId.value}` \n  })\n}\n\nfunction goBack() {\n  uni.navigateBack()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  height: 100vh;\n  background: #fff;\n  display: flex;\n  flex-direction: column;\n}\n\n.header {\n  background: #fff;\n  z-index: 10;\n  \n  .header-inner {\n    height: 88rpx;\n    padding: 0 20rpx;\n    @include flex-between;\n    \n    .back-btn, .placeholder { width: 80rpx; @include flex-center; }\n    \n    .title {\n      font-size: 34rpx;\n      font-weight: 800;\n      color: #1a1a1a;\n      letter-spacing: -1rpx;\n    }\n  }\n}\n\n.main-list { flex: 1; height: 0; }\n\n.grid {\n  padding: 30rpx;\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 20rpx;\n}\n\n.wall-card {\n  height: 580rpx;\n  background: #f8f9fa;\n  border-radius: 32rpx;\n  overflow: hidden;\n  position: relative;\n  box-shadow: $shadow-sm;\n  \n  image { width: 100%; height: 100%; }\n  \n  .overlay {\n    position: absolute;\n    inset: 0;\n    background: linear-gradient(to top, rgba(0,0,0,0.5) 0%, transparent 40%);\n    padding: 20rpx;\n    display: flex;\n    align-items: flex-end;\n    \n    .info {\n      flex: 1;\n      @include flex-between;\n      .name { color: #fff; font-size: 24rpx; font-weight: 600; @include text-ellipsis; flex: 1; }\n      .score { color: #ffd700; font-size: 22rpx; font-weight: 800; margin-left: 10rpx; }\n    }\n  }\n}\n\n.loading-status, .no-more, .empty-state {\n  text-align: center;\n  padding: 40rpx;\n  color: #ccc;\n  font-size: 24rpx;\n  font-weight: 600;\n  letter-spacing: 2rpx;\n}\n\n.dot-loading {\n  width: 40rpx;\n  height: 40rpx;\n  border: 4rpx solid #f1f3f5;\n  border-top-color: $brand-color;\n  border-radius: 50%;\n  margin: 0 auto;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin { to { transform: rotate(360deg); } }\n\n.safe-bottom { height: env(safe-area-inset-bottom); }\n</style>","import MiniProgramPage from 'D:/HBuilderPrograms/qingpingWallapaper/pages/wallpaper/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","onMounted","getWallpaperList"],"mappings":";;;;;;;;;;;AAoEA,MAAM,WAAW;;;;AARjB,UAAM,kBAAkBA,cAAG,IAACC,cAAG,MAAC,kBAAiB,EAAG,mBAAmB,EAAE;AACzE,UAAM,aAAaD,cAAG,IAAC,EAAE;AACzB,UAAM,eAAeA,cAAG,IAAC,EAAE;AAC3B,UAAM,OAAOA,cAAG,IAAC,EAAE;AACnB,UAAM,OAAOA,cAAG,IAAC,EAAE;AACnB,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,UAAUA,cAAG,IAAC,IAAI;AACxB,UAAM,UAAUA,cAAG,IAAC,CAAC;AAGrBE,kBAAAA,UAAU,MAAM;AACd,YAAM,QAAQ,gBAAiB;AAC/B,YAAM,UAAU,MAAM,MAAM,SAAS,CAAC,EAAE;AACxC,iBAAW,QAAQ,QAAQ,MAAM;AACjC,mBAAa,QAAQ,QAAQ,QAAQ;AACrC,WAAK,QAAQ,QAAQ,QAAQ;AAC7B,eAAS,IAAI;AAAA,IACf,CAAC;AAED,mBAAe,SAAS,SAAS,OAAO;AACtC,UAAI,QAAQ;AAAO;AAEnB,UAAI,QAAQ;AACV,gBAAQ,QAAQ;AAChB,gBAAQ,QAAQ;AAChB,aAAK,QAAQ,CAAE;AAAA,MAChB;AAED,UAAI,CAAC,QAAQ;AAAO;AAEpB,cAAQ,QAAQ;AAEhB,UAAI;AACF,cAAM,MAAM,MAAMC,gCAAiB;AAAA,UACjC,YAAY,WAAW;AAAA,UACvB,MAAM,KAAK;AAAA,UACX,SAAS,QAAQ;AAAA,UACjB;AAAA,QACN,CAAK;AAGD,YAAI,QAAQ,UAAU,GAAG;AACvB,eAAK,QAAQ,IAAI;AAAA,QACvB,OAAW;AACL,eAAK,QAAQ,CAAC,GAAG,KAAK,OAAO,GAAG,IAAI,IAAI;AAAA,QACzC;AAGD,YAAI,KAAK,MAAM,UAAU,IAAI,SAAS,IAAI,KAAK,SAAS,UAAU;AAChE,kBAAQ,QAAQ;AAAA,QACtB,OAAW;AACL,kBAAQ;AAAA,QACT;AAAA,MACF,SAAQ,GAAG;AACVF,sBAAAA,MAAA,MAAA,SAAA,mCAAc,iBAAiB,CAAC;AAAA,MACpC,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACjB;AAAA,IACH;AAEA,aAAS,WAAW;AAClB,UAAI,CAAC,QAAQ,SAAS,QAAQ,OAAO;AACnC,iBAAU;AAAA,MACX;AAAA,IACH;AAEA,aAAS,YAAY,MAAM;AACzBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,6BAA6B,KAAK,EAAE,SAAS,KAAK,KAAK,eAAe,WAAW,KAAK;AAAA,MAC/F,CAAG;AAAA,IACH;AAEA,aAAS,SAAS;AAChBA,oBAAAA,MAAI,aAAc;AAAA,IACpB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrIA,GAAG,WAAW,eAAe;"}