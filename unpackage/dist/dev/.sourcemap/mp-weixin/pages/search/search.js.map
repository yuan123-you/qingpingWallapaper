{"version":3,"file":"search.js","sources":["pages/search/search.vue","../../HBuilder X/HBuilderX.4.87.2025121004/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2VhcmNoL3NlYXJjaC52dWU"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"header\" :style=\"{ paddingTop: statusBarHeight + 'px' }\">\n      <view class=\"search-wrap\">\n        <!-- 左上角返回按钮 -->\n        <view class=\"nav-back\" @click=\"goBack\">\n          <uni-icons type=\"left\" size=\"24\" color=\"#1a1a1a\"></uni-icons>\n        </view>\n\n        <view class=\"input-box\">\n          <uni-icons type=\"search\" size=\"18\" color=\"#999\"></uni-icons>\n          <input \n            v-model=\"keyword\" \n            placeholder=\"搜索你想要的壁纸...\" \n            placeholder-style=\"color:#ccc\"\n            @confirm=\"doSearch\"\n            focus\n          />\n          <text class=\"clear\" v-if=\"keyword\" @click=\"keyword = ''\">✕</text>\n        </view>\n        \n        <text class=\"action-btn\" @click=\"doSearch\">搜索</text>\n        \n        <!-- 适配胶囊按钮占位 -->\n        <view class=\"capsule-placeholder\"></view>\n      </view>\n    </view>\n\n    <scroll-view scroll-y class=\"content\">\n      <!-- 推荐和历史 -->\n      <view v-if=\"!searched\" class=\"search-init fade-in-up\">\n        <view class=\"section\" v-if=\"history.length\">\n          <view class=\"sec-header\">\n            <text>搜索历史</text>\n            <uni-icons type=\"trash\" size=\"16\" color=\"#ccc\" @click=\"clearHistory\"></uni-icons>\n          </view>\n          <view class=\"tags\">\n            <text v-for=\"h in history\" :key=\"h\" @click=\"quickSearch(h)\">{{ h }}</text>\n          </view>\n        </view>\n\n        <view class=\"section\">\n          <view class=\"sec-header\"><text>热门推荐</text></view>\n          <view class=\"tags\">\n            <text v-for=\"t in hotTags\" :key=\"t\" @click=\"quickSearch(t)\" class=\"hot\">{{ t }}</text>\n          </view>\n        </view>\n      </view>\n\n      <!-- 搜索结果 -->\n      <view v-else class=\"results\">\n        <view class=\"grid\" v-if=\"results.length\">\n          <view \n            class=\"wall-card fade-in-up\" \n            v-for=\"(item, index) in results\" \n            :key=\"item.id\"\n            :style=\"{ animationDelay: index * 0.05 + 's' }\"\n            @click=\"goToPreview(item)\"\n          >\n            <image :src=\"item.pic_url\" mode=\"aspectFill\"></image>\n            <view class=\"info\">\n              <text class=\"title\">{{ item.title }}</text>\n              <text class=\"score\">★ {{ item.score }}</text>\n            </view>\n          </view>\n        </view>\n        <view class=\"empty-state\" v-else>\n          <uni-icons type=\"info\" size=\"60\" color=\"#eee\"></uni-icons>\n          <text>没找到相关的壁纸，换个词试试？</text>\n        </view>\n      </view>\n      <view class=\"safe-bottom\"></view>\n    </scroll-view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { searchWallpaper, getHotSearch } from '@/api/user/index.js'\nimport { throttle } from '@/utils/common.js'\n\nconst statusBarHeight = ref(uni.getSystemInfoSync().statusBarHeight || 20)\nconst keyword = ref('')\nconst searched = ref(false)\nconst results = ref([])\nconst history = ref([])\nconst hotTags = ref(['雪山', '极简', '赛博朋克', '星空', '猫咪', '森林'])\n\nonMounted(() => {\n  history.value = uni.getStorageSync('search_history') || []\n  loadHot()\n})\n\nasync function loadHot() {\n  const res = await getHotSearch()\n  if (res.list) hotTags.value = res.list\n}\n\nconst doSearch = throttle(async () => {\n  if (!keyword.value.trim()) return\n  searched.value = true\n  \n  // 保存历史\n  if (!history.value.includes(keyword.value)) {\n    history.value.unshift(keyword.value)\n    history.value = history.value.slice(0, 10)\n    uni.setStorageSync('search_history', history.value)\n  }\n\n  const res = await searchWallpaper({ keyword: keyword.value })\n  results.value = res.list\n}, 500)\n\nfunction quickSearch(t) {\n  keyword.value = t\n  doSearch()\n}\n\nfunction clearHistory() {\n  history.value = []\n  uni.setStorageSync('search_history', [])\n}\n\nfunction goToPreview(item) {\n  uni.navigateTo({ url: `/pages/preview/preview?id=${item.id}` })\n}\n\nfunction goBack() {\n  uni.navigateBack()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  height: 100vh;\n  background: #fff;\n  display: flex;\n  flex-direction: column;\n}\n\n.header {\n  padding: 10rpx 30rpx 10rpx 10rpx; // 调整padding\n  background: #fff;\n  \n  .search-wrap {\n    display: flex;\n    align-items: center;\n    height: 88rpx;\n    \n    .nav-back {\n      width: 68rpx;\n      height: 88rpx;\n      @include flex-center;\n      margin-right: 6rpx;\n    }\n\n    .input-box {\n      flex: 1;\n      height: 72rpx;\n      background: #f1f3f5;\n      border-radius: 40rpx;\n      padding: 0 30rpx;\n      display: flex;\n      align-items: center;\n      gap: 16rpx;\n      \n      input {\n        flex: 1;\n        font-size: 28rpx;\n      }\n      \n      .clear {\n        color: #ccc;\n        font-size: 24rpx;\n        padding: 10rpx;\n      }\n    }\n    \n    .action-btn {\n      font-size: 28rpx;\n      color: #333;\n      font-weight: 600;\n      padding: 0 20rpx;\n    }\n    \n    .capsule-placeholder {\n      width: 170rpx; // 微信胶囊按钮占位\n      height: 100%;\n    }\n  }\n}\n\n.content {\n  flex: 1;\n}\n\n.search-init {\n  padding: 40rpx;\n  \n  .section {\n    margin-bottom: 60rpx;\n    \n    .sec-header {\n      @include flex-between;\n      margin-bottom: 24rpx;\n      \n      text {\n        font-size: 32rpx;\n        font-weight: 800;\n        color: #333;\n      }\n    }\n    \n    .tags {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 20rpx;\n      \n      text {\n        padding: 12rpx 30rpx;\n        background: #f8f9fa;\n        border-radius: 30rpx;\n        font-size: 26rpx;\n        color: #666;\n        \n        &.hot {\n          background: #e9f7f3;\n          color: $brand-color;\n          font-weight: 600;\n        }\n      }\n    }\n  }\n}\n\n.results {\n  padding: 20rpx 30rpx;\n  \n  .grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 20rpx;\n  }\n  \n  .wall-card {\n    border-radius: 20rpx;\n    overflow: hidden;\n    position: relative;\n    box-shadow: $shadow-sm;\n    height: 480rpx;\n    \n    image { width: 100%; height: 100%; }\n    \n    .info {\n      position: absolute;\n      bottom: 0; left: 0; right: 0;\n      padding: 20rpx;\n      background: linear-gradient(to top, rgba(0,0,0,0.6), transparent);\n      \n      .title { color: #fff; font-size: 24rpx; font-weight: 600; display: block; }\n      .score { color: #fccb90; font-size: 20rpx; margin-top: 4rpx; }\n    }\n  }\n}\n\n.empty-state {\n  padding: 100rpx 40rpx;\n  display: flex;\n  flex-direction: column;\n  @include flex-center;\n  gap: 30rpx;\n  \n  .empty-img {\n    width: 200rpx;\n    height: 200rpx;\n    border-radius: 40rpx;\n    filter: grayscale(1);\n    opacity: 0.3;\n  }\n  \n  text {\n    font-size: 26rpx;\n    color: #999;\n  }\n}\n\n.safe-bottom {\n  height: env(safe-area-inset-bottom);\n}\n</style>","import MiniProgramPage from 'D:/HBuilderPrograms/qingpingWallapaper/pages/search/search.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","onMounted","getHotSearch","throttle","searchWallpaper"],"mappings":";;;;;;;;;;;;;;;AAiFA,UAAM,kBAAkBA,cAAG,IAACC,cAAG,MAAC,kBAAiB,EAAG,mBAAmB,EAAE;AACzE,UAAM,UAAUD,cAAG,IAAC,EAAE;AACtB,UAAM,WAAWA,cAAG,IAAC,KAAK;AAC1B,UAAM,UAAUA,cAAG,IAAC,EAAE;AACtB,UAAM,UAAUA,cAAG,IAAC,EAAE;AACtB,UAAM,UAAUA,cAAAA,IAAI,CAAC,MAAM,MAAM,QAAQ,MAAM,MAAM,IAAI,CAAC;AAE1DE,kBAAAA,UAAU,MAAM;AACd,cAAQ,QAAQD,cAAAA,MAAI,eAAe,gBAAgB,KAAK,CAAE;AAC1D,cAAS;AAAA,IACX,CAAC;AAED,mBAAe,UAAU;AACvB,YAAM,MAAM,MAAME,4BAAc;AAChC,UAAI,IAAI;AAAM,gBAAQ,QAAQ,IAAI;AAAA,IACpC;AAEA,UAAM,WAAWC,aAAQ,SAAC,YAAY;AACpC,UAAI,CAAC,QAAQ,MAAM,KAAM;AAAE;AAC3B,eAAS,QAAQ;AAGjB,UAAI,CAAC,QAAQ,MAAM,SAAS,QAAQ,KAAK,GAAG;AAC1C,gBAAQ,MAAM,QAAQ,QAAQ,KAAK;AACnC,gBAAQ,QAAQ,QAAQ,MAAM,MAAM,GAAG,EAAE;AACzCH,sBAAAA,MAAI,eAAe,kBAAkB,QAAQ,KAAK;AAAA,MACnD;AAED,YAAM,MAAM,MAAMI,eAAe,gBAAC,EAAE,SAAS,QAAQ,OAAO;AAC5D,cAAQ,QAAQ,IAAI;AAAA,IACtB,GAAG,GAAG;AAEN,aAAS,YAAY,GAAG;AACtB,cAAQ,QAAQ;AAChB,eAAU;AAAA,IACZ;AAEA,aAAS,eAAe;AACtB,cAAQ,QAAQ,CAAE;AAClBJ,0BAAI,eAAe,kBAAkB,EAAE;AAAA,IACzC;AAEA,aAAS,YAAY,MAAM;AACzBA,0BAAI,WAAW,EAAE,KAAK,6BAA6B,KAAK,EAAE,IAAI;AAAA,IAChE;AAEA,aAAS,SAAS;AAChBA,oBAAAA,MAAI,aAAc;AAAA,IACpB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChIA,GAAG,WAAW,eAAe;"}